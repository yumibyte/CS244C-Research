# Workload-aware tuner config for 8× A100 single-node allreduce
# Based on Phase 3 iteration-proxy: Simple protocol gave best mean iteration time
# for ~4 MB allreduce with compute. Tree is best algorithm on this topology (Phase 1).
#
# Format: collective_type,min_bytes,max_bytes,algorithm,protocol,channels,nNodes,nRanks,numPipeOps,regBuff
# nNodes=1, nRanks=8; -1 = use NCCL default or match any

# Proxy size range (1 MB–8 MB): iteration-time-optimal from Phase 3
allreduce,1048576,8388608,tree,simple,-1,1,8,-1,-1

# Small messages: same policy for consistency
allreduce,0,1048575,tree,simple,-1,1,8,-1,-1

# Large messages: tree+simple (bandwidth still strong; consistent iteration behavior)
allreduce,8388609,4294967295,tree,simple,-1,1,8,-1,-1
